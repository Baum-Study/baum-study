# 동기화란

동시다발적으로 실행되는 프로세스들은 서로 협력하며 영향을 주고받습니다. 이러한 자원의 일관성을 보장하기 위해 프로세스 동기화가 필요합니다. 스레드 또한 실행의 문맥을 갖기 때문에 동기화의 대상이 됩니다.

## 동기화의 의미

동기화는 프로세스들의 수행 시기를 맞추고 실행 순서를 제어하여 프로세스를 올바른 순서대로 실행하도록 하는 것을 의미합니다.

## 실행 순서 제어 예시

- **Writer**: `book.txt` 파일에 값을 저장하는 프로세스
- **Reader**: `book.txt` 파일에서 값을 읽어들이는 프로세스
- Reader 프로세스는 `book.txt` 파일에 값이 존재해야 실행될 수 있습니다.

## 상호 배제 예시

- 계좌에 잔액 10만원, 프로세스 A는 2만원을 추가하고, 프로세스 B는 5만원을 추가합니다.
- 한 프로세스가 잔액에 접근할 때 다른 프로세스는 대기해야 합니다. 동시에 접근하면 잔액 계산에 오류가 발생합니다.

## 공유 자원과 임계 구역

### 공유 자원

여러 프로세스 또는 스레드가 공유하는 자원으로 전역 변수, 파일, 입출력 장치 등이 포함됩니다.

### 임계 구역

공유 자원에 접근하는 코드 영역으로, 동시에 실행하면 문제가 발생합니다. 임계 구역에 진입한 프로세스 외에는 대기해야 하며, 동시에 접근하면 레이스 컨디션이 발생할 수 있습니다.

# 동기화 기법

운영체제가 임계 구역 문제를 해결하기 위해 사용하는 세 가지 원칙:

1. **상호 배제**: 한 프로세스가 임계 구역에 진입하면 다른 프로세스는 진입할 수 없습니다.
2. **진행**: 임계 구역에 프로세스가 없다면 진입하고자 하는 프로세스는 들어갈 수 있어야 합니다.
3. **유한 대기**: 프로세스가 임계 구역에 진입하고자 하면 언젠가는 진입할 수 있어야 합니다.

### 뮤텍스 락 (Mutex Lock)

- 상호 배제를 위한 동기화 도구로, 동시에 접근하면 안 되는 자원에 대한 접근을 제어합니다.
- **전역 변수**: 자물쇠 역할
- **acquire 함수**: 임계 구역을 잠금
- **release 함수**: 임계 구역의 잠금을 해제

### 세마포 (Semaphore)

- 뮤텍스 락보다 일반화된 동기화 도구로, 공유 자원이 여러 개일 경우에도 적용 가능합니다.
- **전역 변수 S**: 임계 구역 진입 가능 프로세스의 개수
- **wait 함수**: 임계 구역에 진입 대기
- **signal 함수**: 대기 중인 프로세스의 진입을 허용

### 모니터 (Monitor)

- 세마포보다 사용이 편리한 동기화 도구로, 공유 자원과 접근 인터페이스를 묶어 관리합니다.
- 프로세스는 반드시 인터페이스를 통해서만 공유 자원에 접근하며, 조건 변수를 통해 실행 순서를 제어합니다.
- **조건 변수**: 프로세스 실행 순서를 제어하기 위한 특별한 변수
    - `wait()`: 대기 상태로 변경
    - `signal()`: 대기 상태에서 실행 상태로 변경
