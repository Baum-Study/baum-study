## ☁️ 쿠버네티스란.

- 쿠버네티스는 컨테이너 인프라 환경의 표준과도 같음
- 컨테이너 인프라 환경 : 여러 개의 컨테이너가 격리된 상태로 실행되는 인프라환경을 뜻함
- 2015년 구글이 쿠버네티스를 오픈소스로 공개함
- 쿠버네티스는 컨테이너 오케스트레이션을 위한 솔루션
- 컨테이너 오케스트레이션 : 애플리케이션을 자동으로 배포, 관리, 확장, 네트워킹 및 복구하는 프로세스를 뜻함
- k8c 라고도 표현함 (kubernetes) k + 8글자 + s

## ☁️ 컨테이너 오케스트레이션 비교.

- 컨테이너 오케스트레이션 종류 : 도커 스웜, 메소스, 노매드, 쿠버네티스 등등
- 도커스웜 : 설치 및 사용 간단, 기능 다양하지 않아 대규모 환경에 적용시 사용자 환경 변경이 필요함
- 메소스 : 아파치의 오픈 소스 프로젝트, 기능을 충분히 활용하려면 분산관리 시스템과 연동해야함
- 노매드 : 설치 간단, 기능 부족하여 간단한 기능한 필요한 환경에서 사용하는 것이 권장됨
- 쿠버네티스는 러닝커브가 높고 설치가 어렵지만, 그 외 사용편이성, 안정성, 정보량, 확장성, 세부 설정 지원 등이 매우 잘되어있기 때문에 다른 컨테이너 오케스트레이션들보다 높은 편

## ☁️ 쿠버네티스 구성하기.

- 쿠버네티스 구성 방법 (3)
    - (1) EKS, AKS, GKE 등을 사용 → 관리를 업체에서 진행
    - (2) Rancher, OpenShift 플랫폼에서 제공하는 설치형 쿠버네티스 사용 → 유료
    - (3) kubeadm, kops, KRIB, kubespray 등 사용하는 시스템에 쿠버네티스 클러스터를 자동으로 구성해주는 솔루션 → kubeadm이 사용자가 변경하기도 수월, 배우기도 쉬워 많이 알려져 있음

## ☁️ 쿠버네티스 구성 요소 살펴보기

- 구성 : 마스터 노드, 워커 노드
- 노드 : 클러스터에서 작업을 수행하는 단위
- 마스터 노드 : 클러스터 전체를 관리하고 제어
- 워커노드 : 실제로 애플리케이션이 실행되는 노드

### ⛳️ 마스터 노드의 구성요소

- (1) kubectl
    - 사용자가 Kubernetes 클러스터와 상호작용하기 위한 명령줄 도구
    - 클러스터에 명령을 보내고, 클러스터 상태조회 가능
- (2) API 서버
    - 클러스터의 모든 요청을 처리하는 중심역할 통로
    - 요청을 받아들여 클러스터의 상태를 조회하거나 변경
- (3) etcd
    - 분산 키-값 저장소로, 클러스터의 모든 상태 정보를 저장
    - 클러스터의 중앙 데이터 저장소 역할 → 일관성을 유지
- (4) 컨트롤러 매니저
    - 클러스터의 오브젝트 상태를 관리함
    - 실제 상태가 원하는 상태와 일치하도록 조정
- (5) 스케줄러
    - 새로 생성된 파드를 적절한 워커 노드에 할당하는 역할
    - 각 노드의 현재 리소스 사용량과 가용성을 고려하여 최적의 노드를 선택하는 역할

### ⛳️ 워커 노드의 구성요소

- (1) kubelet
    - 각 워커 노드에서 실행되는 에이전트로 노드의 상태를 모니터링하고, API 서버로부터 받은 파드 사양에 따라 컨테이너를 실행하고 관리하는 역할
- (2) 컨테이너 런타임
    - 실제로 컨테이너를 실행하는 소프트웨어
    - docker 등이 사용됨
- (3) 파드
    - 쿠버네티스의 가장 기본적인 배포 단위
    - 파드는 하나 이상의 컨테이너를 포함할 수 있으며 같은 파드 내의 컨테이너들은 서로 네트워크와 스토리지를 공유
    - 웹 서버 역할을 할 수도 있고 로그나 데이터를 분석할 수도 있음
    - 파드는 언제라도 죽을 수 있는 존재임

## ☁️ 파드 생명주기 (8)

- (1) kubectl 을 통해 API 서버에 파드 생성 요청
- (2) API 서버에 전달된 내용이 있으면 API 서버는 etcd 에 전달된 내용을 모두 기록해 클러스터의 상태 값을 최신으로 유지 → 따라서 각 요소가 상태를 업데이트할 때마다 모두 API 서버를 통해 etcd 에 기록됨
- (3) API 서버에 파드 생성이 요청된 것을 컨트롤러 매니저가 인지하면 컨트롤러 매니저는 파드를 생성하고, 이 상태를 API 서버에 전달함
- (4) API 서버에 파드가 생성됐다는 정보를 스케줄러가 인지함. 스케줄러는 생성된 파드를 어떤 워커노드에 적용할지 조건을 고려해 결정하고 해당 워커노드에 파드를 띄우도록 요청함.
- (5) API 서버에 전달된 정보대로 지정한 워커노드에 파드가 속해 있는지 스케줄러가 kubelet 으로 확인함
- (6) kubelet에서 컨테이너 런타임으로 파드 생성을 요청함
- (7) 파드 생성 완료
- (8) 파드가 사용가능한 상태로 변경됨

## ☁️ 정리

- 쿠버네티스는 작업을 순새대로 진행하는 워크플로 구조가 아니라 선언적인 시스템 구조를 가짐
- 각 요소가 추구하는 상태를 선언하면 현재 상태와 맞는지 점검하고 그것에 맞추려고 노력하는 구조라는 뜻
