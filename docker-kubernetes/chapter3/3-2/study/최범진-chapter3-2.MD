## 파드를 생성하는 방법

### 1. `kubectl run` 명령어로 파드 생성하기

```bash
kubectl run nginx-pod --image=nginx
```

- **kubectl run**: 파드를 생성하는 명령어입니다.
- **nginx-pod**: 파드의 이름입니다.
- **-image=nginx**: 사용할 도커 이미지입니다.
- **특징**: 단일 파드를 생성합니다. 간단한 테스트나 개발 용도로 사용됩니다.

### 2. `kubectl create` 명령어로 파드 생성하기

```bash
kubectl create deployment dpy-nginx --image=nginx
```

- **kubectl create**: 다양한 쿠버네티스 오브젝트를 생성할 수 있는 명령어입니다.
- **deployment**: 디플로이먼트를 생성합니다.
- **dpy-nginx**: 디플로이먼트의 이름입니다.
- **-image=nginx**: 사용할 도커 이미지입니다.
- **특징**: 레플리카셋을 생성하여 파드의 상태를 자동으로 관리합니다. 필요 시 파드를 재시작하거나 복제합니다.

### 3. 생성된 파드 확인하기

```bash
kubectl get pod
```

- **설명**: 현재 클러스터에 생성된 모든 파드를 확인할 수 있습니다.
- **예시 출력**:
    
    ```sql
    NAME        READY   STATUS    RESTARTS   AGE
    nginx-pod   1/1     Running   0          35s
    ```
    

## 오브젝트(Object)란?

쿠버네티스에서 오브젝트는 시스템이 관리하는 엔티티입니다. 각 오브젝트는 특정 기능을 수행하며, 다양한 속성과 상태를 가집니다.

### 기본 오브젝트

### 1. 파드(Pod)

- **설명**: 쿠버네티스에서 실행되는 최소 단위입니다. 웹 서비스를 구동하는 데 필요한 최소 단위입니다.
- **특징**: 독립적인 공간과 IP를 가지고 있습니다. 하나의 파드는 1개 이상의 컨테이너를 가질 수 있지만, 대부분 1개의 파드에 1개의 컨테이너를 적용합니다.
    - **이유**:
        - 독립적 배포와 확장: 각 컨테이너를 독립적으로 관리 가능.
        - 단일 책임 원칙: 하나의 기능에 집중.
        - 장애 격리: 하나의 파드 실패가 다른 파드에 미치는 영향 최소화.
        - 업데이트 및 롤백 용이: 독립적 버전 관리.
        - 간편한 로깅 및 모니터링: 단순한 관리.

### 2. 네임스페이스(Namespace)

- **설명**: 쿠버네티스 클러스터에서 사용되는 리소스들을 구분해 관리하는 그룹입니다.
- **종류**:
    - default: 지정하지 않으면 기본으로 할당.
    - kube-system: 쿠버네티스 시스템에서 사용.
    - metallb-system: 온-프레미스 환경에서 쿠버네티스를 사용할 경우 외부에서 쿠버네티스 클러스터 내부로 접속하게 도와주는 컨테이너들이 속한 네임스페이스.

### 3. 볼륨(Volume)

- **설명**: 파드가 생성될 때 사용할 수 있는 디렉터리를 제공합니다.
- **특징**: 파드는 영속되는 개념이 아니기 때문에 제공되는 디렉터리도 임시로 사용합니다. 파드가 사라지더라도 저장과 보존이 가능한 디렉터리를 볼륨 오브젝트를 통해 생성하고 사용합니다.

### 4. 서비스(Service)

- **설명**: 파드는 클러스터 내부에서 유동적이기 때문에 접속 정보가 고정일 수 없습니다. 서비스를 통해 파드 접속을 안정적으로 유지할 수 있습니다.
- **특징**: 파드가 새로 생성될 때 부여되는 새로운 IP를 기존에 제공하던 기능과 연결해줍니다. 로드밸런서와 게이트웨이와 비슷한 역할을 수행합니다.

### 디플로이먼트(Deployment)

- **설명**: 기본 오브젝트만으로 쿠버네티스를 사용할 수 있으나 한계가 있기 때문에 이를 좀 더 효율적으로 작동하도록 기능들을 조합하고 추가해 구현한 것입니다.
- **특징**: 파드에 기반을 두고 있으며, 레플리카셋 오브젝트를 합쳐 놓은 형태입니다.

### 레플리카셋(ReplicaSet)으로 파드 수 관리하기

- **설명**: 다수의 파드가 필요할 때 이를 하나씩 생성하면 매우 비효율적입니다. 그래서 쿠버네티스에서는 다수의 파드를 만드는 레플리카셋 오브젝트를 제공합니다.
- **특징**: 레플리카셋은 파드 수를 보장하는 기능만 제공하기 때문에 롤링 업데이트 기능 등이 추가된 디플로이먼트를 사용해 파드 수를 관리하는 것을 권장합니다.

## 스펙을 지정해 오브젝트 관리하기

```yaml
apiVersion: apps/v1 # API 버전
kind: Deployment # 오브젝트 종류
metadata:
  name: echo-hname
  labels:
    app: nginx
spec:
  replicas: 3 # 몇 개의 파드를 생성할지 결정
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: echo-hname
        image: sysnet4admin/echo-hname # 사용되는 이미지
```

- **설명**: YAML 파일로 오브젝트를 정의하여 필요한 설정을 적용할 수 있습니다.
- **특징**: `replicas` 옵션을 사용하여 몇 개의 파드를 생성할지 결정할 수 있습니다.

## `kubectl apply`로 오브젝트 생성하고 관리하기

- **설명**: `kubectl create`로 파드 생성 시 파일의 변경 사항을 바로 적용할 수 없는 문제를 해결하기 위해 `kubectl apply`를 제공합니다.
- **특징**: 일회성 사용으로 오브젝트를 생성할 때 `kubectl create`를 사용하고, 변경이 생길 가능성이 있는 오브젝트는 파일로 작성한 후 `kubectl apply`로 적용하는 것이 좋습니다.

| 구분 | Run | Create | Apply |
| --- | --- | --- | --- |
| 명령 실행 | 제한적임 | 가능함 | 안 됨 |
| 파일 실행 | 안 됨 | 가능함 | 가능함 |
| 변경 가능 | 안 됨 | 안 됨 | 가능함 |
| 실행 편의성 | 매우 좋음 | 매우 좋음 | 좋음 |
| 기능 유지 | 제한적임 | 지원됨 | 다양하게 지원됨 |
